def ROL(data, shift, size=64):
    shift %= size
    remains = data >> (size - shift)
    body = (data << shift) - (remains << size)
    return (body + remains)


def ROR(data, shift, size=64):
    shift %= size
    body = data >> shift
    remains = (data << (size - shift)) - (body << size)
    return (body + remains)


def CheckKeyPadCode(code):
    x = 0
    i = 0

    for digit in code:
        if (digit < 0) or (digit > 9):
            return False

        x = x | (digit << i)
        i += 4

    x = x ^ 0o1275437152437512431354
    x = ROL(x, 10)

    a = x & 1229782938247303441
    b = x & 0o0210421042104210421042
    c = x & ROL(1229782938247303441, 2)
    d = x & ROL(0o0210421042104210421042, 2)

    if ((a == 0x0100101000011110) and (b == 0x2002220020022220) and
            (c == 0x4444040044044400) and (d == 0x8880008080000880)):
        return True
    else:
        return False


x = 0

# 0x0100101000011110
a = 0b0000000100000000000100000001000000000000000000010001000100010000
# 0x2002220020022220
b = 0b0010000000000010001000100000000000100000000000100010001000100000
# 0x4444040044044400
c = 0b0100010001000100000001000000000001000100000001000100010000000000
# 0x8880008080000880
d = 0b1000100010000000000000001000000010000000000000000000100010000000


# 0x1111111111111111
x |= a & 0b0001000100010001000100010001000100010001000100010001000100010001
# 0x2222222222222222
x |= b & 0b0010001000100010001000100010001000100010001000100010001000100010
# 0x4444444444444444
x |= c & 0b0100010001000100010001000100010001000100010001000100010001000100
# 0x8888888888888888
x |= d & 0b1000100010001000100010001000100010001000100010001000100010001000


x = ROR(x, 10)

x = x ^ 0o1275437152437512431354


reversed = format(x, 'x')[::-1]
res = list(map(int, reversed))
assert(CheckKeyPadCode(res) == True)
print(f'CTF{{{reversed}}}')
